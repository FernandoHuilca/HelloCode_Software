<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<AnchorPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="Modulo_Usuario.Controladores.CrudController"
            prefWidth="360.0" prefHeight="720.0"
            style="-fx-background-color: #D6E5E3;">
    
    <!-- ScrollPane principal -->
    <ScrollPane fitToWidth="true" fitToHeight="true" 
                style="-fx-background: transparent; -fx-background-color: transparent; -fx-border-color: transparent;"
                AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0" AnchorPane.bottomAnchor="0">
        
        <VBox spacing="18" alignment="TOP_CENTER" prefWidth="340">
            <padding>
                <Insets top="18" right="10" bottom="10" left="10"/>
            </padding>

            <!-- Header con botón de regresar -->
            <HBox alignment="CENTER_LEFT" spacing="12">
                <Button text="←" onAction="#regresarAlHome"
                        style="-fx-background-color: #A6B1E1; -fx-text-fill: #424874; -fx-font-size: 18px; -fx-font-weight: bold; -fx-background-radius: 20;"
                        prefWidth="40" prefHeight="40"/>
                <VBox alignment="CENTER_LEFT" spacing="6" HBox.hgrow="ALWAYS">
                    <Label text="👥" style="-fx-font-size: 32px;"/>
                    <Label text="Gestión de Usuarios"
                           style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: #424874;"/>
                    <Label fx:id="usuarioActualLabel"
                           text="Usuario: Admin"
                           style="-fx-font-size: 13px; -fx-text-fill: #7f8c8d;"/>
                </VBox>
            </HBox>

            <!-- Lista de usuarios -->
            <VBox spacing="8" style="-fx-background-color: #A6B1E1; -fx-background-radius: 14;" maxHeight="180" minHeight="120" prefWidth="320">
                <Label text="Usuarios Registrados"
                       style="-fx-font-size: 15px; -fx-font-weight: bold; -fx-text-fill: #424874; -fx-padding: 8 0 0 0;"/>
                <ListView fx:id="listaUsuarios"
                          style="-fx-background-radius: 8; -fx-border-radius: 8;"
                          prefHeight="100" maxHeight="120"/>
                <HBox spacing="8" alignment="CENTER">
                    <Button text="🔄"
                            onAction="#actualizarLista"
                            style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-size: 16px; -fx-background-radius: 8;"
                            prefWidth="44"/>
                    <Button text="🗑️"
                            onAction="#eliminarUsuario"
                            style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-size: 16px; -fx-background-radius: 8;"
                            prefWidth="44"/>
                </HBox>
            </VBox>

            <!-- Panel de formulario -->
            <VBox spacing="10" style="-fx-background-color: #DCD6F7; -fx-background-radius: 14;" prefWidth="320">
                <padding>
                    <Insets top="14" right="14" bottom="14" left="14"/>
                </padding>
                <Label text="Agregar/Editar Usuario"
                       style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #424874;"/>

                <!-- Tipo de Usuario -->
                <VBox spacing="4">
                    <Label text="Tipo de Usuario:" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                    <ComboBox fx:id="tipoUsuarioCombo"
                              promptText="Seleccione el tipo"
                              prefHeight="32"/>
                </VBox>

                <!-- Campos básicos -->
                <VBox spacing="4">
                    <Label text="Usuario:" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                    <TextField fx:id="nuevoUsuario"
                               promptText="Ingrese el usuario"
                               prefHeight="32"/>
                </VBox>
                <VBox spacing="4">
                    <Label text="Contraseña:" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                    <PasswordField fx:id="nuevaContrasena"
                                   promptText="Ingrese la contraseña"
                                   prefHeight="32"/>
                </VBox>
                <VBox spacing="4">
                    <Label text="Nombre:" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                    <TextField fx:id="nuevoNombre"
                               promptText="Ingrese el nombre completo"
                               prefHeight="32"/>
                </VBox>
                <VBox spacing="4">
                    <Label text="Email:" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                    <TextField fx:id="nuevoEmail"
                               promptText="Ingrese el email"
                               prefHeight="32"/>
                </VBox>

                <!-- Campos específicos para UsuarioComunidad -->
                <VBox fx:id="camposComunidad" spacing="4" visible="false">
                    <Label text="Nivel Java:" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                    <ComboBox fx:id="nivelJavaCombo"
                              promptText="Seleccione nivel"
                              prefHeight="32"/>
                    <Label text="Reputación:" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                    <TextField fx:id="reputacionField"
                               promptText="0"
                               prefHeight="32"/>
                </VBox>

                <!-- Campos específicos para UsuarioAdministrador -->
                <VBox fx:id="camposAdmin" spacing="4" visible="false">
                    <Label text="Nivel de Acceso:" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                    <TextField fx:id="nivelAccesoField"
                               promptText="1-10"
                               prefHeight="32"/>
                    <HBox spacing="8" alignment="CENTER_LEFT">
                        <CheckBox fx:id="esSuperAdminCheck" text="Es Super Admin"/>
                    </HBox>
                </VBox>

                <!-- Botones de acción -->
                <HBox spacing="10" alignment="CENTER">
                    <Button text="➕"
                            onAction="#agregarUsuario"
                            style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-size: 18px; -fx-background-radius: 8;"
                            prefWidth="44"/>
                    <Button text="✏️"
                            onAction="#editarUsuario"
                            style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-font-size: 18px; -fx-background-radius: 8;"
                            prefWidth="44"/>
                    <Button text="❌"
                            onAction="#limpiarCampos"
                            style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-font-size: 18px; -fx-background-radius: 8;"
                            prefWidth="44"/>
                </HBox>
            </VBox>

            <!-- Mensaje de estado -->
            <Label fx:id="mensajeLabel"
                   style="-fx-font-size: 12px; -fx-text-fill: #e74c3c; -fx-padding: 8 0 0 0;"
                   alignment="CENTER"/>
        </VBox>
    </ScrollPane>
</AnchorPane>
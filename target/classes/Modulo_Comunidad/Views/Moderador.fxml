<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>

<AnchorPane prefHeight="720.0" prefWidth="360.0"
            style="-fx-background-color: linear-gradient(to bottom, #667eea 0%, #764ba2 100%);
                   -fx-font-family: 'Segoe UI';"
            xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="Comunidad_Modulo.Controladores_GUI.Moderador_Controller">

    <!-- Header -->
    <VBox>
        <HBox alignment="CENTER" spacing="10" style="-fx-padding: 10 0 0 0;">
            <ImageView fitHeight="30" fitWidth="30" preserveRatio="true">
                <Image url="@../images/modicon.png"/>
            </ImageView>
            <VBox alignment="CENTER">
                <Text text="Centro de ModeraciÃ³n"
                      style="-fx-fill: white; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                <Text fx:id="lblInfoModerador" text="Sistema | Comunidades: 0"
                      style="-fx-fill: #e8eaf6; -fx-font-size: 10px;"/>
            </VBox>
        </HBox>

        <!-- TabPane Principal -->
        <TabPane fx:id="tabPanePrincipal" layoutY="60" prefHeight="660" prefWidth="360"
                 style="-fx-tab-min-height: 30; -fx-tab-max-height: 30;"
                 tabClosingPolicy="UNAVAILABLE">

            <!-- Tab 1: Vista General -->
            <Tab text="ðŸ“Š Vista General">
                <ScrollPane fitToWidth="true" style="-fx-background-color: transparent;">
                    <VBox spacing="15" style="-fx-padding: 10;">
                        
                        <!-- InformaciÃ³n del Estado -->
                        <VBox spacing="8">
                            <Text text="Estado del Sistema"
                                  style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                            <TextArea fx:id="txtAreaEstadoSistema"
                                      prefHeight="80" wrapText="true" editable="false"
                                      style="-fx-background-color: #ffffff; -fx-background-radius: 8; -fx-border-radius: 8; -fx-border-color: #bdc3c7; -fx-font-size: 10px;"/>
                        </VBox>

                        <!-- EstadÃ­sticas -->
                        <VBox spacing="8">
                            <Text text="EstadÃ­sticas Generales"
                                  style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                            <TextArea fx:id="txtAreaEstadisticas"
                                      prefHeight="80" wrapText="true" editable="false"
                                      style="-fx-background-color: #ffffff; -fx-background-radius: 8; -fx-border-radius: 8; -fx-border-color: #bdc3c7; -fx-font-size: 10px;"/>
                        </VBox>

                        <!-- Acciones RÃ¡pidas -->
                        <VBox spacing="8">
                            <Text text="Acciones RÃ¡pidas"
                                  style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                            <VBox spacing="8">
                                <Button fx:id="btnActualizarInfo" text="ðŸ”„ Actualizar"
                                        onAction="#actualizarInformacionCompleta" prefWidth="300"
                                        style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 8 15; -fx-font-size: 12px;"/>
                                <Button fx:id="btnMostrarEstadisticas" text="ðŸ“Š EstadÃ­sticas"
                                        onAction="#mostrarEstadisticasDetalladas" prefWidth="300"
                                        style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 8 15; -fx-font-size: 12px;"/>
                            </VBox>
                        </VBox>

                        <!-- InformaciÃ³n General -->
                        <VBox spacing="8">
                            <Text text="InformaciÃ³n General"
                                  style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                            <TextArea fx:id="txtAreaInformacion"
                                      prefHeight="100" wrapText="true" editable="false"
                                      style="-fx-background-color: #ffffff; -fx-background-radius: 8; -fx-border-radius: 8; -fx-border-color: #bdc3c7; -fx-font-size: 10px;"/>
                        </VBox>
                    </VBox>
                </ScrollPane>
            </Tab>

            <!-- Tab 2: GestiÃ³n de Usuarios -->
            <Tab text="ðŸ‘¥ GestiÃ³n Usuarios">
                <VBox spacing="15" style="-fx-padding: 15;">
                    
                    <!-- ExpulsiÃ³n de Usuarios -->
                    <VBox spacing="8">
                        <Text text="Expulsar Usuario de Comunidad"
                              style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <VBox spacing="8">
                            <TextField fx:id="txtNombreUsuarioEliminar"
                                       promptText="Nombre de usuario"
                                       prefWidth="320"/>
                            <TextField fx:id="txtNombreComunidad"
                                       promptText="Nombre de comunidad"
                                       prefWidth="320"/>
                            <Button fx:id="btnEliminarUsuario" text="ðŸš« Expulsar"
                                    onAction="#eliminarUsuario" prefWidth="320"
                                    style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 8 15; -fx-font-size: 12px;"/>
                        </VBox>
                    </VBox>

                    <!-- EliminaciÃ³n de Comunidades -->
                    <VBox spacing="8">
                        <Text text="Eliminar Comunidad"
                              style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <VBox spacing="8">
                            <TextField fx:id="txtComunidadEliminar"
                                       promptText="Nombre de la comunidad"
                                       prefWidth="320"/>
                            <Button fx:id="btnEliminarComunidad" text="ðŸ—‘ï¸ Eliminar Comunidad"
                                    onAction="#eliminarComunidad" prefWidth="320"
                                    style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 8 15; -fx-font-size: 12px;"/>
                        </VBox>
                    </VBox>

                    <!-- Sanciones -->
                    <VBox spacing="8">
                        <Text text="GestiÃ³n de Sanciones"
                              style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <VBox spacing="6">
                            <TextField fx:id="txtUsuarioSancion"
                                       promptText="Usuario a sancionar"
                                       prefWidth="320"/>
                            <TextField fx:id="txtRazonSancion"
                                       promptText="RazÃ³n de la sanciÃ³n"
                                       prefWidth="320"/>
                            <TextField fx:id="txtDuracionSancion"
                                       promptText="DuraciÃ³n (minutos)"
                                       prefWidth="320"/>
                        </VBox>
                        <HBox spacing="8">
                            <Button fx:id="btnAplicarSancion" text="âš ï¸ Aplicar"
                                    onAction="#aplicarSancionManual" prefWidth="156"
                                    style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 6 10; -fx-font-size: 11px;"/>
                            <Button fx:id="btnLevantarSancion" text="âœ… Levantar"
                                    onAction="#levantarSancionUsuario" prefWidth="156"
                                    style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 6 10; -fx-font-size: 11px;"/>
                        </HBox>
                        <TextArea fx:id="txtAreaSanciones"
                                  prefHeight="60" wrapText="true" editable="false"
                                  style="-fx-background-color: #ffffff; -fx-background-radius: 6; -fx-border-radius: 6; -fx-border-color: #bdc3c7; -fx-font-size: 10px;"/>
                    </VBox>

                    <!-- Lista de Usuarios -->
                    <VBox spacing="8">
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Text text="Lista de Usuarios"
                                  style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                            <Button fx:id="btnListarUsuarios" text="ðŸ“‹ Actualizar"
                                    onAction="#listarUsuarios"
                                    style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 4 8; -fx-font-size: 10px;"/>
                        </HBox>
                        <TextArea fx:id="txtAreaUsuariosDetalle"
                                  prefHeight="120" wrapText="true" editable="false"
                                  style="-fx-background-color: #ffffff; -fx-background-radius: 6; -fx-border-radius: 6; -fx-border-color: #bdc3c7; -fx-font-size: 10px;"/>
                    </VBox>
                </VBox>
            </Tab>

            <!-- Tab 3: Contenido de Comunidades -->
            <Tab text="ðŸ’¬ Contenido Comunidades">
                <VBox spacing="15" style="-fx-padding: 15;">
                    
                    <!-- Selector de Comunidad -->
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Text text="Comunidad:" style="-fx-fill: #2c3e50; -fx-font-size: 12px; -fx-font-weight: bold;"/>
                        <ComboBox fx:id="comboComunidades" promptText="Seleccionar comunidad" prefWidth="180"/>
                        <Button fx:id="btnCargarContenido" text="ðŸ”„"
                                onAction="#cargarContenidoComunidad"
                                style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 4 8; -fx-font-size: 10px;"/>
                    </HBox>

                    <!-- Contenido de Grupos -->
                    <VBox spacing="10">
                        <!-- Grupos de DiscusiÃ³n -->
                        <VBox spacing="8">
                            <Text text="Grupos de DiscusiÃ³n"
                                  style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                            <TextArea fx:id="txtAreaGruposDiscusion"
                                      prefHeight="120" wrapText="true" editable="false"
                                      style="-fx-background-color: #ffffff; -fx-background-radius: 6; -fx-border-radius: 6; -fx-border-color: #bdc3c7; -fx-font-size: 10px;"/>
                        </VBox>

                        <!-- Grupos de Compartir -->
                        <VBox spacing="8">
                            <Text text="Grupos de Compartir"
                                  style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                            <TextArea fx:id="txtAreaGruposCompartir"
                                      prefHeight="120" wrapText="true" editable="false"
                                      style="-fx-background-color: #ffffff; -fx-background-radius: 6; -fx-border-radius: 6; -fx-border-color: #bdc3c7; -fx-font-size: 10px;"/>
                        </VBox>
                    </VBox>

                    <!-- Chats Privados -->
                    <VBox spacing="8">
                        <Text text="Chats Privados (SupervisiÃ³n)"
                              style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <TextArea fx:id="txtAreaChatsPrivados"
                                  prefHeight="100" wrapText="true" editable="false"
                                  style="-fx-background-color: #ffffff; -fx-background-radius: 6; -fx-border-radius: 6; -fx-border-color: #bdc3c7; -fx-font-size: 10px;"/>
                    </VBox>

                    <!-- Acciones de ModeraciÃ³n -->
                    <HBox spacing="10">
                        <Button fx:id="btnRevisarContenido" text="ðŸ” Revisar"
                                onAction="#revisarContenidoReportado" prefWidth="160"
                                style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 6 10; -fx-font-size: 11px;"/>
                        <Button fx:id="btnEscanearForos" text="ðŸ›¡ï¸ Escanear"
                                onAction="#escanearForosAutomatico" prefWidth="160"
                                style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 6 10; -fx-font-size: 11px;"/>
                    </HBox>
                </VBox>
            </Tab>

            <!-- Tab 4: Historial -->
            <Tab text="ðŸ“ˆ Historial">
                <VBox spacing="20" style="-fx-padding: 20;">
                    
                    <!-- Selectores de Historial -->
                    <VBox spacing="10">
                        <Text text="ConfiguraciÃ³n de Historial"
                              style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <VBox spacing="8">
                            <ComboBox fx:id="comboTipoGrupo" promptText="Tipo de Grupo" prefWidth="320"/>
                            <ComboBox fx:id="comboGrupos" promptText="Seleccionar Grupo" prefWidth="320"/>
                            <Button fx:id="btnVerHistorial" text="ðŸ” Ver Historial"
                                    onAction="#verHistorial" prefWidth="320"
                                    style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-background-radius: 6; -fx-padding: 8 15; -fx-font-size: 12px;"/>
                        </VBox>
                    </VBox>

                    <!-- Ãrea de Historial -->
                    <VBox spacing="10">
                        <Text text="Historial de Actividades"
                              style="-fx-fill: #2c3e50; -fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <TextArea fx:id="txtAreaHistorial"
                                  prefHeight="350" wrapText="true" editable="false"
                                  style="-fx-background-color: #ffffff; -fx-background-radius: 8; -fx-border-radius: 8; -fx-border-color: #bdc3c7; -fx-font-size: 10px;"/>
                    </VBox>
                </VBox>
            </Tab>
        </TabPane>
    </VBox>

    <!-- BotÃ³n de Cerrar (fijo en la esquina) -->
    <Button fx:id="btnVolver" text="âŒ Cerrar"
            layoutX="130" layoutY="600"
            onAction="#volver"
            style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-background-radius: 15; -fx-padding: 8 15; -fx-font-size: 12px;"/>

</AnchorPane>
